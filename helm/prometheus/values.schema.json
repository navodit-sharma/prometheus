{
    "$schema": "http://json-schema.org/schema#",
    "type": "object",
    "properties": {
        "ambassador": {
            "type": "object",
            "properties": {
                "ambassadorConfig": {
                    "type": "string"
                },
                "authService": {
                    "type": "object",
                    "properties": {
                        "create": {
                            "type": "boolean"
                        },
                        "optional_configurations": {
                            "type": "null"
                        }
                    }
                },
                "crds": {
                    "type": "object",
                    "properties": {
                        "create": {
                            "type": "boolean"
                        },
                        "enabled": {
                            "type": "boolean"
                        },
                        "keep": {
                            "type": "boolean"
                        }
                    }
                },
                "createDevPortalMappings": {
                    "type": "boolean"
                },
                "daemonSet": {
                    "type": "boolean"
                },
                "deploymentStrategy": {
                    "type": "object",
                    "properties": {
                        "type": {
                            "type": "string"
                        }
                    }
                },
                "enableAES": {
                    "type": "boolean"
                },
                "module": {
                    "type": "object",
                    "properties": {
                        "config": {
                            "type": "string"
                        }
                    }
                },
                "priorityClassName": {
                    "type": "string"
                },
                "rateLimit": {
                    "type": "object",
                    "properties": {
                        "create": {
                            "type": "boolean"
                        }
                    }
                },
                "rbac": {
                    "type": "object",
                    "properties": {
                        "create": {
                            "type": "boolean"
                        }
                    }
                },
                "redis": {
                    "type": "object",
                    "properties": {
                        "create": {
                            "type": "boolean"
                        }
                    }
                },
                "replicaCount": {
                    "type": "integer"
                },
                "resources": {
                    "type": "object"
                },
                "scope": {
                    "type": "object",
                    "properties": {
                        "singleNamespace": {
                            "type": "boolean"
                        }
                    }
                },
                "service": {
                    "type": "object",
                    "if": {
                        "properties": {
                            "type": {
                                "const": "LoadBalancer"
                            }
                        }
                    },
                    "then": {
                        "required": [
                            "loadBalancerIP"
                        ],
                        "properties": {
                            "loadBalancerIP": {
                                "pattern": "[0-9]+.[0-9]+.[0-9]+.[0-9]+"
                            }
                        }
                    },
                    "properties": {
                        "externalTrafficPolicy": {
                            "type": "string",
                            "enum": [
                                "Local"
                            ]
                        },
                        "loadBalancerIP": {
                            "type": "string"
                        },
                        "type": {
                            "type": "string",
                            "enum": [
                                "LoadBalancer",
                                "ClusterIP",
                                "NodePort"
                            ]
                        }
                    }
                }
            }
        },
        "global": {
            "type": "object",
            "required": [
                "externalUrl",
                "smtpApiKey",
                "smtpDestinationAddress"
            ],
            "properties": {
                "ambassador": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "externalUrl": {
                    "type": "string",
                    "minLength": 1,
                    "examples": [
                        "abc.xyz.com",
                        "something.abc.xyz.com" 
                    ]
                },
                "kube-prometheus-stack": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "prometheus-elasticsearch-exporter": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "smtpApiKey": {
                    "type": "string"
                },
                "smtpDestinationAddress": {
                    "type": "string"
                }
            }
        },
        "kube-prometheus-stack": {
            "type": "object",
            "properties": {
                "alertmanager": {
                    "type": "object",
                    "if": {
                      "properties": {
                        "enabled": {
                          "const": true
                        }
                      }
                    },
                    "then": {
                        "properties": {
                            "alertmanagerSpec": {
                                "required": [
                                    "externalUrl"
                                ],
                                "properties": {
                                    "externalUrl": {
                                        "pattern": "http://[a-z0-9.-]+/alertmanager",
                                        "$comment": "Ex. http://{{ .Values.global.externalUrl }}/alertmanager"
                                    }
                                }
                            }
                        }
                    },
                    "properties": {
                        "alertmanagerSpec": {
                            "type": "object",
                            "properties": {
                                "externalUrl": {
                                    "type": "string"
                                },
                                "logLevel": {
                                    "type": "string"
                                },
                                "priorityClassName": {
                                    "type": "string"
                                },
                                "retention": {
                                    "type": "string"
                                },
                                "routePrefix": {
                                    "type": "string"
                                },
                                "storage": {
                                    "type": "object"
                                }
                            }
                        },
                        "config": {
                            "type": "object"
                        },
                        "enabled": {
                            "type": "boolean"
                        },
                        "tplConfig": {
                            "type": "boolean"
                        }
                    }
                },
                "defaultRules": {
                    "type": "object",
                    "properties": {
                        "create": {
                            "type": "boolean"
                        },
                        "rules": {
                            "type": "object",
                            "properties": {
                                "alertmanager": {
                                    "type": "boolean"
                                },
                                "etcd": {
                                    "type": "boolean"
                                },
                                "general": {
                                    "type": "boolean"
                                },
                                "k8s": {
                                    "type": "boolean"
                                },
                                "kubeApiserver": {
                                    "type": "boolean"
                                },
                                "kubeApiserverAvailability": {
                                    "type": "boolean"
                                },
                                "kubeApiserverError": {
                                    "type": "boolean"
                                },
                                "kubeApiserverSlos": {
                                    "type": "boolean"
                                },
                                "kubePrometheusGeneral": {
                                    "type": "boolean"
                                },
                                "kubePrometheusNodeAlerting": {
                                    "type": "boolean"
                                },
                                "kubePrometheusNodeRecording": {
                                    "type": "boolean"
                                },
                                "kubeScheduler": {
                                    "type": "boolean"
                                },
                                "kubeStateMetrics": {
                                    "type": "boolean"
                                },
                                "kubelet": {
                                    "type": "boolean"
                                },
                                "kubernetesAbsent": {
                                    "type": "boolean"
                                },
                                "kubernetesApps": {
                                    "type": "boolean"
                                },
                                "kubernetesResources": {
                                    "type": "boolean"
                                },
                                "kubernetesStorage": {
                                    "type": "boolean"
                                },
                                "kubernetesSystem": {
                                    "type": "boolean"
                                },
                                "network": {
                                    "type": "boolean"
                                },
                                "node": {
                                    "type": "boolean"
                                },
                                "prometheus": {
                                    "type": "boolean"
                                },
                                "prometheusOperator": {
                                    "type": "boolean"
                                },
                                "time": {
                                    "type": "boolean"
                                }
                            }
                        }
                    }
                },
                "fullnameOverride": {
                    "type": "string"
                },
                "grafana": {
                    "type": "object",
                    "properties": {
                        "adminPassword": {
                            "type": "string"
                        },
                        "adminUser": {
                            "type": "string"
                        },
                        "dashboardProviders": {
                            "type": "object"
                        },
                        "dashboards": {
                            "type": "object"
                        },
                        "deploymentStrategy": {
                            "type": "object",
                            "properties": {
                                "type": {
                                    "type": "string"
                                }
                            }
                        },
                        "enabled": {
                            "type": "boolean"
                        },
                        "env": {
                            "type": "object",
                            "if": {
                                "properties": {
                                    "GF_SMTP_ENABLED": {
                                        "const": "true"
                                    }
                                }
                            },
                            "then": {
                                "required": [
                                    "GF_SMTP_PASSWORD",
                                    "GF_SMTP_USER"
                                ],
                                "properties": {
                                    "GF_SMTP_PASSWORD": {
                                        "minLength": 1
                                    },
                                    "GF_SMTP_USER": {
                                        "minLength": 1
                                    }
                                }
                            },
                            "properties": {
                                "GF_SECURITY_ADMIN_PASSWORD": {
                                    "type": "string",
                                    "minLength": 12
                                },
                                "GF_SECURITY_ADMIN_USER": {
                                    "type": "string",
                                    "minLength": 5
                                },
                                "GF_SERVER_ROOT_URL": {
                                    "type": "string"
                                },
                                "GF_SMTP_ENABLED": {
                                    "type": "string",
                                    "enum": [
                                        "true",
                                        "false"
                                    ]
                                },
                                "GF_SMTP_PASSWORD": {
                                    "type": "string"
                                },
                                "GF_SMTP_USER": {
                                    "type": "string"
                                }
                            }
                        },
                        "grafana.ini": {
                            "type": "object"
                        },
                        "livenessProbe": {
                            "type": "object"
                        },
                        "nodeSelector": {
                            "type": "object"
                        },
                        "persistence": {
                            "type": "object",
                            "properties": {
                                "accessModes": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    }
                                },
                                "enabled": {
                                    "type": "boolean"
                                },
                                "size": {
                                    "type": "string"
                                },
                                "storageClassName": {
                                    "type": "string"
                                },
                                "type": {
                                    "type": "string"
                                }
                            }
                        },
                        "priorityClassName": {
                            "type": "string"
                        },
                        "readinessProbe": {
                            "type": "object"
                        },
                        "replicas": {
                            "type": "integer"
                        },
                        "resources": {
                            "type": "object"
                        },
                        "tolerations": {
                            "type": "array"
                        }
                    }
                },
                "kubeControllerManager": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "kubeEtcd": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "kubeProxy": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "kubeScheduler": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "kubeStateMetrics": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "nameOverride": {
                    "type": "string"
                },
                "nodeExporter": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                },
                "prometheus": {
                    "type": "object",
                    "properties": {
                        "additionalPodMonitors": {
                            "type": "array"
                        },
                        "additionalServiceMonitors": {
                            "type": "array"
                        },
                        "enabled": {
                            "type": "boolean"
                        },
                        "prometheusSpec": {
                            "type": "object",
                            "properties": {
                                "evaluationInterval": {
                                    "type": "string"
                                },
                                "externalLabels": {
                                    "type": "object",
                                    "minProperties": 1
                                },
                                "externalUrl": {
                                    "type": "string"
                                },
                                "logLevel": {
                                    "type": "string"
                                },
                                "priorityClassName": {
                                    "type": "string"
                                },
                                "retention": {
                                    "type": "string"
                                },
                                "routePrefix": {
                                    "type": "string"
                                },
                                "scrapeInterval": {
                                    "type": "string"
                                },
                                "scrapeTimeout": {
                                    "type": "string"
                                },
                                "storageSpec": {
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "prometheusOperator": {
                    "type": "object",
                    "properties": {
                        "admissionWebhooks": {
                            "type": "object",
                            "properties": {
                                "patch": {
                                    "type": "object",
                                    "properties": {
                                        "priorityClassName": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        },
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                }
            }
        },
        "prometheus-elasticsearch-exporter": {
            "type": "object",
            "properties": {
                "es": {
                    "type": "object",
                    "properties": {
                        "cluster_settings": {
                            "type": "boolean"
                        },
                        "uri": {
                            "type": "string"
                        }
                    }
                },
                "resources": {
                    "type": "object"
                },
                "serviceMonitor": {
                    "type": "object",
                    "properties": {
                        "enabled": {
                            "type": "boolean"
                        }
                    }
                }
            }
        }
    }
}
